<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Comments for static websites, using GitHub Issues. - Paul Knopf</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="/dist/styles.css" rel="stylesheet" type="text/css"/>
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112478642-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-112478642-1');
  </script>
</head>
<body>
<header class="bg-light mb-5">
  <div class="navbar navbar-expand">
    <div class="container">
      <a href="/" class="navbar-brand d-flex">
        <strong>paul knopf</strong>
      </a>
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/archive">archive</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/about">about</a>
        </li>
      </ul>
    </div>
  </div>
</header>
<main>
  
<div class="container">
    <div class="post">
        <h1 class="title">
            Comments for static websites, using GitHub Issues.
        </h1>
        <p class="submitted">
            posted on Oct 13, 2018
        </p>
        <div class="content">
            <p>I have been using Disqus for my blog discussions. They began forcing ads on their free-tier users. I wouldn't normally care except for the fact that the ads were large, irrelevant and click-baity. This blog isn't highly trafficked so I shouldn't really care, but it just irritated me. So, I began looking for a different solution that was free with no-ads.</p>
<h1 id="my-options">My options</h1>
<p>I've written off many options that I won't even bother to list. The reasons being I want:</p>
<ul>
<li>Ad-free</li>
<li>No cost</li>
<li>Privacy/security (no Facebook comments, Disqus, etc)</li>
</ul>
<p>With that said, here were some options I considered.</p>
<h2 id="staticman">Staticman</h2>
<p><a href="https://staticman.net/" target="_blank" class="btn btn-light">Website</a></p>
<p>Since I currently use GitHub to host my blog, this looked appealing. All you do is add a custom <code>form</code> element that posts comments to a third-party service, which will then automatically commit the comment to your repository (or open a pull request for moderation). It is up to your build scripts to properly render the comments that are committed into your repository.</p>
<p>I can see this as a powerful tool for many use-cases, but not for blog comments, due to the missing authentication and notifications.</p>
<h2 id="utterances">Utterances</h2>
<p><a href="https://utteranc.es/" target="_blank" class="btn btn-light">Website</a></p>
<p>This looked even more appealing than Staticman. It uses GitHub Issues. Since I'm a developer, I'd love to be able to use <a href="https://github.github.com/gfm/">GitHub Flavored Markdown</a>. It also gives you authentication and notifications.</p>
<p>This product requires an external server to be up and online at all times. And while they do promise to be always free without ads, they don't promise to be always <em>available</em>. And while they are open-source and I could always decide to host my own Utterances server/bot, I'd prefer to host nothing at all. This isn't a super deal breaker, because in the end, all content is stored in GitHub Issues.</p>
<h2 id="gitment">Gitment</h2>
<p><a href="https://github.com/imsun/gitment" target="_blank" class="btn btn-light">Website</a></p>
<p>Gitment is similar to Utterances. It uses GitHub Issues as well. It doesn't seem to be under active development, but maybe it's &quot;done&quot;?</p>
<p>Honestly, Utterances seems a lot more polished. If I had to choose between Gitment or Utterances, I'd go with Utterances.</p>
<h1 id="my-solution">My solution</h1>
<p>Using the inspiration from these solutions, I decided to host my comments on GitHub Issues. But instead of using client-side scripting to render and post comments, I'd do it all on the server side when generating my static site.</p>
<p>Since I am using <a href="https://github.com/pauldotknopf/statik">Statik</a> (a tool I wrote) to generate my static site, it is really easy to customize and perform the server-side rendering of the comments.</p>
<p>So, in my blog post's front-matter, I embedded a GitHub Issue ID that will host the discussion.</p>
<pre><code class="language-yml hljs"><span class="hljs-meta">---</span>
<span class="hljs-attr">comment_issue_id:</span> <span class="hljs-number">1</span>
<span class="hljs-meta">---</span></code></pre>
<p>Then I use <a href="https://github.com/octokit/octokit.net">Octokit</a> to query the current comments to render them.</p>
<pre><code class="language-csharp hljs"><span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> post <span class="hljs-keyword">in</span> posts)
{
    <span class="hljs-keyword">if</span> (post.CommentIssueID.HasValue)
    {
        post.Comments = <span class="hljs-keyword">new</span> List&lt;GitHubComment&gt;();
        <span class="hljs-keyword">var</span> comments = <span class="hljs-keyword">await</span> _github.Issue.Comment.GetAllForIssue(<span class="hljs-string">"pauldotknopf"</span>, <span class="hljs-string">"pauldotknopf.github.io"</span>, post.CommentIssueID.Value);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> comment <span class="hljs-keyword">in</span> comments)
        {
            <span class="hljs-keyword">var</span> body = <span class="hljs-keyword">await</span> _github.Miscellaneous.RenderArbitraryMarkdown(<span class="hljs-keyword">new</span> NewArbitraryMarkdown(comment.Body, <span class="hljs-string">"gfm"</span>, <span class="hljs-string">"pauldotknopf/pauldotknopf.github.io"</span>));
            post.Comments.Add(<span class="hljs-keyword">new</span> GitHubComment
            {
                Id = comment.Id,
                CreatedAt = comment.CreatedAt,
                UpdatedAt = comment.UpdatedAt,
                User = comment.User.Login,
                UserAvatarUrl = comment.User.AvatarUrl,
                Body = body,
                Reactions = comment.Reactions
            });
        }
    }
}</code></pre>
<p>Since I am querying the comments on the server, I can use authenticated GitHub requests, which give me a higher request rate-limit.</p>
<p>I can then render the content how I want (in Razor, see <a href="https://github.com/pauldotknopf/pauldotknopf.github.io/blob/b5d615711a14f69c09f098f4a2373cecc2f4cf6f/generator/src/Blog/Resources/Views/Blog/Post.cshtml#L18">here</a>).</p>
<p>A few drawbacks:</p>
<ul>
<li>No ability to comment directly from the blog post. I don't really mind this since I don't like asking users for OAuth permissions anyway. Instead, I guide them directly to GitHub for the comments.</li>
<li>Out-of-date data. Since we render the comments on the server side, we wouldn't capture any new comments or new edits immediately. I use a cron-job in Travis CI to rebuild my site every 24-hours to help alleviate this issue. I wish there was some (easy) way to trigger a Travis CI build each time a comment is posted or updated on a GitHub Issue.</li>
</ul>
<p>There is no harm in switching to Utterances in the future. It is a lot easier to implement, but I'm more partial to having smaller dependencies and fewer external services.</p>
<p>You can play around with <a href="/post/2018-10-10-test-github-comments">this</a> blog post.</p>
<p>In the end, my blog doesn't get much traffic. Who cares? :-)</p>
<p>Titty sprinkles.</p>

        </div>
            <hr />
            <h3>Comments</h3>
                    <div class="comment">
                        <div class="comment-user">
                            <a href="https://github.com/Structed" target="_blank">
                                <img src="https://avatars3.githubusercontent.com/u/29922?v=4"/>
                            </a>
                        </div>
                        <div class="comment-main">
                            <div class="header">
                                <a href="https://github.com/Structed" target="_blank" class="user">Structed</a> commented
                                <a href="https://github.com/pauldotknopf/pauldotknopf.github.io/issues/6#issuecomment-448008058" target="_blank" class="time">
                                    <relative-time datetime="2018-12-17T21:38:12.0000000&#x2B;00:00">
                                        Dec 17, 2018
                                    </relative-time>
                                </a>&nbsp;
                            </div>
                            <div class="body">
                                <p>Thank you, really cool way to do comments for a static site to do comments. And also on the commenter's side, this is a fairly good user experience.</p>
                            </div>
                            <div class="footer">
                                <ul class="nav">
                                        <li class="nav-item">
                                            <a class="nav-link active" href="#">
                                                <g-emoji alias="+1" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f44d.png" class="emoji">üëç</g-emoji> 1
                                            </a>
                                        </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="comment">
                        <div class="comment-user">
                            <a href="https://github.com/slowbreathing" target="_blank">
                                <img src="https://avatars1.githubusercontent.com/u/3428899?v=4"/>
                            </a>
                        </div>
                        <div class="comment-main">
                            <div class="header">
                                <a href="https://github.com/slowbreathing" target="_blank" class="user">slowbreathing</a> commented
                                <a href="https://github.com/pauldotknopf/pauldotknopf.github.io/issues/6#issuecomment-512642497" target="_blank" class="time">
                                    <relative-time datetime="2019-07-18T02:43:17.0000000&#x2B;00:00">
                                        Jul 18, 2019
                                    </relative-time>
                                </a>&nbsp;
                            </div>
                            <div class="body">
                                <p>just checking</p>
                            </div>
                            <div class="footer">
                                <ul class="nav">
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="comment">
                        <div class="comment-user">
                            <a href="https://github.com/jdillard" target="_blank">
                                <img src="https://avatars3.githubusercontent.com/u/3474095?v=4"/>
                            </a>
                        </div>
                        <div class="comment-main">
                            <div class="header">
                                <a href="https://github.com/jdillard" target="_blank" class="user">jdillard</a> commented
                                <a href="https://github.com/pauldotknopf/pauldotknopf.github.io/issues/6#issuecomment-633779841" target="_blank" class="time">
                                    <relative-time datetime="2020-05-26T02:48:25.0000000&#x2B;00:00">
                                        May 26, 2020
                                    </relative-time>
                                </a>&nbsp;
                            </div>
                            <div class="body">
                                <p>Great post! I adapted this for my Jekyll blog and ended up using GitHub Actions to trigger my Netlify build hook any time a comment is created, edited, or deleted.</p>
<p>I documented the process here: <a href="https://jareddillard.com/blog/using-github-issues-for-static-blog-comments.html" rel="nofollow">https://jareddillard.com/blog/using-github-issues-for-static-blog-comments.html</a>.</p>
                            </div>
                            <div class="footer">
                                <ul class="nav">
                                        <li class="nav-item">
                                            <a class="nav-link active" href="#">
                                                <g-emoji alias="+1" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f44d.png" class="emoji">üëç</g-emoji> 2
                                            </a>
                                        </li>
                                </ul>
                            </div>
                        </div>
                    </div>
            <p class="text-center">
                <a class="btn btn-primary btn-light btn-lg" target="_blank" href="https://github.com/pauldotknopf/pauldotknopf.github.io/issues/6#new_comment_field"><i class="fab fa-github"></i> Join the discussion at GitHub</a>
            </p>
    </div>
</div>
</main>
<footer class="bg-light py-3 mt-5 text-muted text-center">
  <a href="https://github.com/pauldotknopf/pauldotknopf.github.io"><i class="fab fa-github"></i> source</a>
</footer>
<script src="/dist/scripts.js"></script>
</body>
</html>
